# Распиновка USB Floppy Emulator

## Поддерживаемые платформы

- **Raspberry Pi Pico** (RP2040) - 160 KB кеш
- **Raspberry Pi Pico 2** (RP2350) - 320 KB кеш

## Назначение пинов (GPIO0-GPIO15)

### UART для отладки (зарезервировано)
- **GPIO0** - UART0 TX (отладочный вывод)
- **GPIO1** - UART0 RX (отладочный ввод)

### I2C для OLED дисплея (SSD1306)
- **GPIO2** - I2C1 SDA (данные)
- **GPIO3** - I2C1 SCL (тактовый сигнал)

### SPI для SD карты
- **GPIO4** - SPI0 MISO (RX)
- **GPIO5** - SPI0 CS (Chip Select)
- **GPIO6** - SPI0 SCK (тактовый сигнал)
- **GPIO7** - SPI0 MOSI (TX)

### Энкодер с кнопкой
- **GPIO10** - Encoder A (фаза A)
- **GPIO11** - Encoder B (фаза B)
- **GPIO12** - Encoder Button (кнопка)

### USB
- Встроенный USB используется для:
  - MSC (Mass Storage Class) - эмуляция флоппи-дисковода
  - CDC (Serial) - отладочный вывод

## Схема подключения

```
Raspberry Pi Pico/Pico2          OLED SSD1306 (I2C)
┌─────────────────┐              ┌──────────────┐
│                 │              │              │
│ GPIO0 (TX)  ────┼── UART Debug │              │
│ GPIO1 (RX)  ────┼── UART Debug │              │
│                 │              │              │
│ GPIO2 (SDA) ────┼──────────────┤ SDA          │
│ GPIO3 (SCL) ────┼──────────────┤ SCL          │
│ 3.3V        ────┼──────────────┤ VCC          │
│ GND         ────┼──────────────┤ GND          │
│                 │              └──────────────┘
│                 │
│                 │              SD Card Module
│                 │              ┌──────────────┐
│ GPIO4 (MISO)────┼──────────────┤ DO (MISO)    │
│ GPIO5 (CS)  ────┼──────────────┤ CS           │
│ GPIO6 (SCK) ────┼──────────────┤ SCK          │
│ GPIO7 (MOSI)────┼──────────────┤ DI (MOSI)    │
│ 3.3V        ────┼──────────────┤ VCC          │
│ GND         ────┼──────────────┤ GND          │
│                 │              └──────────────┘
│                 │
│                 │              Rotary Encoder
│                 │              ┌──────────────┐
│ GPIO10      ────┼──────────────┤ CLK (A)      │
│ GPIO11      ────┼──────────────┤ DT (B)       │
│ GPIO12      ────┼──────────────┤ SW (Button)  │
│ GND         ────┼──────────────┤ GND          │
│                 │              └──────────────┘
└─────────────────┘
```

## Примечания

1. **Совместимость с Nano RP2040/RP2350**: Все пины в диапазоне GPIO0-GPIO15 для максимальной совместимости с компактными платами.

2. **Питание**: 
   - OLED и SD карта питаются от 3.3V
   - Энкодер питается от GND

3. **Pull-up резисторы**:
   - I2C: Встроенные в Pico (можно включить программно)
   - SPI: Не требуются
   - Encoder: Встроенные pull-up включаются программно

4. **Частоты**:
   - I2C: 400 kHz (Fast Mode)
   - SPI: 12.5 MHz

## Автоматическое определение платформы

Проект автоматически определяет тип платформы при компиляции:
- Для **Pico 2** (RP2350): выделяется 320 KB кеш
- Для **Pico 1** (RP2040): выделяется 160 KB кеш

Размер кеша настраивается в `config.h` через макрос `CACHE_SIZE_KB`.
